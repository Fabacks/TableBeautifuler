/**
 * TableBeautifuller
 * 
 * Author: Fabacks
 * License: Free distribution except for commercial use
 * GitHub Repository: https://github.com/Fabacks/TableBeautifuller
 * Version 0.9.1
 * 
 * This software is provided "as is" without any warranty. The author is
 * not responsible for any damages or liabilities caused by the use of this software.
 * Please do not use this software for commercial purposes without explicit permission from the author.
 * If you use or distribute this software, please credit the author and link back to the GitHub repository.
 */

class TableBeautifullerExport{constructor(t={}){this.tableBF=null,this.options={},this.options.csv=t.exportCSV??!0,this.options.copy=t.copy??!0}install(t){this.tableBF=t,this.tableBF.getTableData=this.getTableData.bind(this),this.tableBF.copyTableData=this.copyTableData.bind(this),this.tableBF.exportTableToCSV=this.exportTableToCSV.bind(this),this.createWrappers()}createWrappers(){const t=document.querySelector(".tableBeautifuller.pagination-wrapper-top-container"),e=document.createElement("div");e.style.cssText="align-self: flex-end; display: flex; gap: 10px; margin: 10px 0;",this.options.copy&&this.addCopyButton(e),this.options.csv&&this.addCSVButton(e),t.appendChild(e)}addCopyButton(t){const e=document.createElement("button");e.innerText=this.tableBF.translator("copy"),e.title=this.tableBF.translator("copyTitle"),t.appendChild(e),e.addEventListener("click",(()=>{this.tableBF.copyTableData()}))}addCSVButton(t){const e=document.createElement("button");e.innerText=this.tableBF.translator("csv"),e.title=this.tableBF.translator("csvTitle"),t.appendChild(e);e.addEventListener("click",(()=>{this.tableBF.exportTableToCSV("tableDatas.csv")}))}getTableData(){const t=[],e=this.tableBF.table.querySelectorAll("thead tr:not(.thead-search)");for(let a of e)t.push(Array.from(a.querySelectorAll("th")).map((t=>-1!==t.innerHTML.indexOf("<span")?t.innerHTML.substring(0,t.innerHTML.indexOf("<span")).trim():t.innerText)));const a=this.tableBF.table.querySelectorAll("tbody tr");for(let e of a)t.push(Array.from(e.querySelectorAll("td")).map((t=>t.innerText)));return t}copyTableData(){const t=this.getTableData().map((t=>t.join("\t"))).join("\n");try{navigator.clipboard.writeText(t),alert(this.tableBF.translator("copyExported"))}catch(t){console.error("Failed to copy text: ",t)}}exportTableToCSV(t){const e=this.getTableData().map((t=>t.map((t=>t)).join(";"))).join("\n");let a,o;a=new Blob([e],{type:"text/csv"}),o=document.createElement("a"),o.download=t,o.href=window.URL.createObjectURL(a),o.style.display="none",document.body.appendChild(o),o.click()}}